<div class="dashboard">
  <div class="main-area">
    <div class="stats-grid">
      <!-- Last Patient Checkup -->
      <div class="stat-card" *ngIf="lastCheckup(); else noCheckup">
        <div class="stat-label">Last Patient Checkup</div>
        <div class="stat-value">
          {{ lastCheckup()?.visitDate | date : 'dd MMM yyyy' }}
        </div>
        <div class="stat-subtext">
          {{ lastCheckup()?.patientName }}
        </div>
      </div>

      <ng-template #noCheckup>
        <div class="stat-card">
          <div class="stat-label">Last Patient Checkup</div>
          <div class="stat-value">â€”</div>
          <div class="stat-subtext">No checkups yet</div>
        </div>
      </ng-template>

      <!-- Total Checkups -->
      <div class="stat-card">
        <div class="stat-label">Total Patient Checkups</div>
        <div class="stat-value">{{ totalCheckups() }}</div>
      </div>

      <!-- Top Patients -->
      <div class="stat-card">
        <div class="stat-label">Top Patients</div>

        <div class="stat-subtext" *ngIf="topPatients().length === 0">
          No data
        </div>

        <div class="stat-subtext" *ngFor="let p of topPatients()">
          {{ p.patientName }} ({{ p.visitCount }})
        </div>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>Patient Visit Analytics</h3>

        <select
          [value]="chartFilter()"
          aria-label="chartFilter"
          (change)="setFilter($any($event.target).value)"
        >
          <option value="current-month">Current Month</option>
          <option value="last-3-months">Last 3 Months</option>
          <option value="current-year">Current Year</option>
          <option value="last-year">Last Year</option>
        </select>
      </div>

      <canvas id="doctorVisitChart"></canvas>
    </div>
  </div>
</div>